[Settings]
# ===== Header Region Settings =====
header_area_top = 2
header_area_left = 12
header_area_width = 45
header_area_height = 6

# Pages to read (comma-separated, 1-based, or 'all' for all pages)
# Use 'all' for PDF splitting to read every page
pages_to_read = all

# ===== Pattern Validation Settings =====
enable_pattern_validation = true

# Expected format: [Prefix]-[Country]-[Code]-[Serial]
# Example: B-HK-WFE-S17975643 (4 parts)
# Or: B-WFE-S17975643 (3 parts, no country)
expected_parts = 4
min_expected_parts = 3
expected_separator = -
expected_digit_count = 8
min_digit_count = 6

# Pattern structure
pattern_prefix_length = 1
pattern_country_min = 1
pattern_country_max = 2
pattern_code_min = 2
pattern_code_max = 4
pattern_serial_min = 7
pattern_serial_max = 9

# Allowed serial prefixes (comma-separated)
# Example: S17975643, R12345678
pattern_serial_allowed_prefixes = S,R
serial_prefix_required = true
serial_digits_exact = 0
invalid_serial_score_cap = 89
serial_close_match_threshold = 0.85

# ===== Performance Settings =====
enable_parallel_processing = true
max_workers = 4

# ===== Adaptive Rendering (NEW in V3) =====
# Start with low scale, escalate if score is low
adaptive_rendering = true
initial_render_scale = 2.0
max_render_scale = 6.0
score_threshold_for_escalation = 70

# ===== OCR Budget Control (NEW in V3) =====
# Limit number of OCR attempts to improve speed
max_ocr_attempts = 12
early_exit_score = 90
voting_method_score_threshold = 70

# ===== OCR Optimization =====
ocr_filter_black_text = true
ocr_black_threshold = 100

# ===== OCR Enhancement (V3.1 - Full Upgrade) =====
# Optional full path to tesseract executable (leave blank for auto-detect)
# Example: C:/Program Files/Tesseract-OCR/tesseract.exe
tesseract_cmd =

# Tesseract PSM Mode (7 = single text line, best for headers)
tesseract_psm_mode = 7

# Character Whitelist (only allow specific characters)
# For header format: B-HK-FI4-S18008633
tesseract_char_whitelist = ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-

# Pre-processing enhancements
enable_deskewing = true
enable_morphological_ops = true
enable_clahe = true

# Multiple OCR Engines
enable_multi_engine = false
use_easyocr = false
use_paddleocr = false

# Pattern-based post-correction
enable_pattern_correction = true

# ===== Input/Output Paths (NEW in V3) =====
# Input folder for PDF files to process
input_folder = input

# Output folder structure: {output_base_dir}/{YYYY}/{YYYY-MM-DD}/files
output_base_dir = output
organize_by_year_and_date = true
output_retention_days = 0

# Reports folder structure: {reports_base_dir}/{YYYY-MM-DD}/reports
reports_base_dir = reports
reports_organize_by_date = true

# ===== Debug Images =====
save_debug_images = true
debug_images_folder = debug_images
organize_by_date = true
save_method_images = true
image_retention_days = 30

# ===== API Logging =====
api_log_url = http://mth-vm-pdw/pdw-picklist-api/api/PDW/AddExtractionLog
enable_api_logging = true

# Async logging (NEW in V3) - non-blocking
api_log_async = true
api_queue_size = 1000
api_timeout = 5
circuit_breaker_threshold = 5

# ===== Filename Sanitization =====
remove_special_chars = true
replace_spaces_with = _
max_filename_length = 100

# ===== PDF Splitting =====
enable_pdf_splitting = true
# min_pages_per_split: minimum pages required per split (0 = no minimum, split all groups)
min_pages_per_split = 0
header_similarity_threshold = 0.85
enable_serial_based_matching = true
split_naming_pattern = {header}

# ===== Logging (NEW in V3) =====
# Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
log_level = INFO
log_method_details = false

# ===== Performance Metrics (NEW in V3) =====
enable_metrics_tracking = true
metrics_export_path = metrics.json

# ===== Flexible Header Matching (V3) =====
# Support both:
# - prefix/code/serial
# - prefix/country/serial
# - prefix/country/code/serial
enable_pattern_check = true
header_pattern = ^[A-Z](?:-[A-Z0-9]{1,8}){1,2}-[SR][0-9]{7,8}$
tesseract_confidence_threshold = 82.0
ambiguous_characters = S:5,B:8,P:F,O:0,I:1,Z:2
character_whitelist = ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-

# ===== Code Ambiguity Monitor (observe-only) =====
# Track OCR ambiguity for customer code segment (e.g. 0 vs O in 020H/02OH).
# This does not auto-correct output in phase 1.
enable_code_ambiguity_monitor = true
code_ambiguity_pairs = O:0
code_ambiguity_only_mixed_alnum = true
enable_code_ambiguity_autocorrect = false
code_autocorrect_min_support = 1
code_autocorrect_require_scale_evidence = true
code_autocorrect_force_multi_scale = true
enable_code_anchor_harmonize = true
code_anchor_harmonize_min_glyph_support = 1
enable_code_glyph_disambiguation = true
code_zero_to_o_width_ratio = 1.12
enable_code_char_classifier = true
code_char_classifier_min_confidence = 0.72
code_char_classifier_min_margin = 0.12
code_char_classifier_allow_leading_zero_to_o = false
code_char_classifier_enable_width_vote = true
code_char_classifier_min_vote_support = 2
code_char_classifier_require_evidence = false
code_char_classifier_min_evidence_support = 2
code_char_tesseract_confidence_threshold = 72
code_char_box_padding_ratio = 0.18
enable_code_glyph_width_fallback = false
enable_code_ambiguity_confirm_high_scale = true
code_ambiguity_confirm_scale = 6.0
code_box_alignment_ambiguity_pairs = O:0,S:5,F:E
code_box_alignment_min_match_ratio = 0.35
enable_code_anchor_rescue_pass = true
code_anchor_rescue_scale = 7.5
code_anchor_rescue_only_on_no_char_boxes = true
